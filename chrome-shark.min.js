var ChromeShark=function(){function t(){function e(){return this.playerInfo&&this.playerInfo.GetSong()&&0!=this.playerInfo.GetSong().length||(this.playerInfo=this.chromeSharkInterface==this.Interface.Grooveshark?{GetSong:function(){return n("#now-playing-metadata .song")},GetArtist:function(){return n("#now-playing-metadata .artist")},GetTimeElapsed:function(){return n("#now-playing #time-elapsed")},GetTimeTotal:function(){return n("#now-playing #time-total")},GetControls:function(){return n("#play-controls")}}:{GetSong:function(){return n("iframe#app-player").contents().find("#track-name")},GetArtist:function(){return n("iframe#app-player").contents().find("#track-artist")},GetTimeElapsed:function(){return n("iframe#app-player").contents().find("#track-current")},GetTimeTotal:function(){return n("iframe#app-player").contents().find("#track-length")},GetControls:function(){return n("iframe#app-player").contents().find("#controls")}}),this.playerInfo.GetSong()&&0!=this.playerInfo.GetSong().length}function a(t){var e=this;this.chromeSharkInterface==this.Interface.Grooveshark&&(t=t||n(".chrome-shark-meta-data-container"),t&&(e.$playControls=e.playerInfo.GetControls().clone().removeAttr("id").addClass("chrome-shark-track-controls-button").css({"margin-left":"auto","margin-right":"auto","margin-bottom":"50px",width:"90px"}),e.$playControls.find("a").click(function(){var t=n(this),r=n("#"+t.attr("id"));r.click()}),e.$playControls.find("#play-pause").click(function(){n(this).toggleClass("playing")}),n(".chrome-shark-track-controls-button").remove(),t.find(".chrome-shark-progress-bar-container").before(this.$playControls)),clearTimeout(e.updatePlayerControlsTimeout),e.updatePlayerControlsTimeout=setTimeout(function(){a.call(e)},r.updateTimePlayerControls))}function s(){var t=this,a=e.call(t);if(a){var i=t.playerInfo.GetSong().text(),c=t.playerInfo.GetArtist().text(),l=t.playerInfo.GetTimeElapsed().text().trim()||"0:00",h=t.playerInfo.GetTimeTotal().text().trim()||"0:00";if(i&&c){if(n(".chrome-shark-track-info").show(),n(".chrome-shark-track-no-info").hide(),n(".chrome-shark-track-controls").show(),n(".chrome-shark-title").text()!=i&&n(".chrome-shark-title").text(this.songTitle),n(".chrome-shark-artist").text()!=c&&n(".chrome-shark-artist").text(this.artist),n(".chrome-shark-time-elapsed").text()!=l){n(".chrome-shark-time-elapsed").text(this.timeElapsed);var m=0;if(this.timeElapsed&&this.timeTotal){var p=new RegExp("[0-9]+","g"),d=parseInt(l.match(p)[0]),f=parseInt(l.match(p)[1]),u=parseInt(h.match(p)[0]),g=parseInt(h.match(p)[1]);m=(60*d+f)/(60*u+g)*100}var k=n(".chrome-shark-progress-bar-current-progress");k&&k.css({width:m+"%"})}n(".chrome-shark-time-total").text()!=h&&n(".chrome-shark-time-total").text(this.timeTotal);var b=!1;if(i!=this.songTitle&&(this.songTitle=i,b=!0),c!=this.artist&&(this.artist=c),b&&o.call(t),n(".chrome-shark-album-art")&&n(".chrome-shark-album-art").attr("src")!=this.albumArtUrl&&!this.currentlyLoadingImage){this.currentlyLoadingImage=!0;var y=n(".chrome-shark-album-art").clone();y.attr("src",this.albumArtUrl).hide(),y.load(function(){t.currentlyLoadingImage=!1,n(".chrome-shark-album-art").after(y).remove(),n(".chrome-shark-album-art").stop(!0,!0).show()})}h!=this.timeTotal&&(this.timeTotal=h),l!=this.timeElapsed&&(this.timeElapsed=l)}else n(".chrome-shark-track-info").hide(),n(".chrome-shark-track-no-info").show(),n(".chrome-shark-track-controls").hide()}clearTimeout(this.updateMetaDataTimeout),this.updateMetaDataTimeout=setTimeout(function(){s.call(t)},r.updateTimeMetaData)}function o(){var t=this;n.ajax("https://ws.audioscrobbler.com/2.0/?method=track.getInfo&api_key="+r.lastFmApiKey+"&artist="+encodeURI(t.artist)+"&track="+encodeURI(t.songTitle)+"&format=json",{success:function(e){var a=e.track,s=r.defaultAlbumArtUrl;if(a&&a.album){var o=a.album.image[a.album.image.length-1]["#text"];if(-1==o.indexOf("noimage")){var i=new RegExp("serve/.+/","g");s=o.replace(i,"serve/_/")}}t.albumArtUrl=s,n.ajax("https://ws.audioscrobbler.com/2.0/?method=artist.getInfo&api_key="+r.lastFmApiKey+"&artist="+encodeURI(t.artist)+"&format=json",{success:function(e){if(e&&e.artist){if(e.artist.image){var a=e.artist,s=a.image[a.image.length-1]["#text"];t.albumArtUrl==r.defaultAlbumArtUrl&&s&&(t.albumArtUrl=s)}a.bio.summary?(n(".chrome-shark-artist-bio-summary").html(a.bio.summary),t.artistBio=a.bio.summary,n(".chrome-shark-artist-bio-summary").find("a").css({color:"#4A4A4A"}),n(".chrome-shark-artist-bio").show()):(n(".chrome-shark-artist-bio-summary").empty(),n(".chrome-shark-artist-bio").hide(),t.artistBio="")}}})}})}function i(){var t=this;this.GetDependencies(function(){t.DetectInterfaceType(),e.call(t),s.call(t),t.Show()})}var n=null;this.songTitle="",this.artist="",this.artistBio="",this.timeElapsed="",this.timeTotal="",this.$playControls=null,this.currentlyLoadingImage=!1,this.updateMetaDataTimeout=null,this.updatePlayerControlsTimeout=null,this.playerInfo=void 0,this.chromeSharkInterface=void 0,this.Show=function(){var t=this;if(this.IsUICreated())n(".chrome-shark").show();else{var e=n("<div class='chrome-shark'>").css({display:"block",position:"fixed",width:"100%",height:"100%",left:"0",top:"0","z-index":"99999999999"}),o=n("<div class=chrome-shark-album-art-container>").css({display:"block",width:"55%",height:"100%",background:"linear-gradient(#111119 0%, #0C3A5F 100%)","z-index":"99999999999","float":"left"}),i=n("<img class='chrome-shark-album-art'>").css({width:"100%",height:"100%"});t.albumArtUrl=r.defaultAlbumArtUrl,i.attr("src",r.defaultAlbumArtUrl),o.append(i);var c=n("<div class='chrome-shark-meta-data-container'>").css({padding:"20px","background-color":"#FFF",margin:"80px 50px 20px 50px",display:"block",position:"absolute",height:"auto",bottom:"0",top:"0",left:"0",right:"0","border-radius":"10px","min-width":"400px","min-height":"270px","overflow-y":"auto"}),l=n("<span>Now playing | <a class='chrome-shark-close-button'>Close</a></span>").css({color:"white","float":"right","padding-top":"10px","font-size":"12pt","font-weight":"normal"});l.find(".chrome-shark-close-button").css({color:"#00B0D0"}),n(document).keyup(function(r){27===r.keyCode&&t.ToggleShow()}),l.find(".chrome-shark-close-button").click(function(r){r.preventDefault(),t.Close()});var h=n("<div class='chrome-shark-toolbar'>").css({transform:"translateZ(0)",padding:"12px","-ms-transition":".3s","background-image":"linear-gradient(top, #333, #222)",filter:"progid:DXImageTransform.Microsoft.Gradient(startColorstr='#ff333333', endColorstr='#ff222222', GradientType=0)","-webkit-transform":"translateZ(0)","-moz-transform":"translateZ(0)","-ms-transform":"translateZ(0)","min-width":"400px","text-align":"left"}).append(l).append("<span class='logo-chrome-shark'><span class='logo-chrome'>Chrome</span><span class='logo-shark'>Shark</span></span>");c.append("<div class='chrome-shark-track-info'>    <span>        <span class='chrome-shark-title'></span>        <div class='chrome-shark-artist-container'>            <span class='chrome-shark-artist-prefix'>by </span><span class='chrome-shark-artist'></span>        </div>    </span></div><div class='chrome-shark-track-controls'>     <span class='chrome-shark-time-elapsed-total' style='color:white'>        <span class='chrome-shark-time-elapsed'></span> / <span class='chrome-shark-time-total'></span>    </span>    <div class='chrome-shark-progress-bar-container'>     <div class='chrome-shark-progress-bar'>       <div class='chrome-shark-progress-bar-current-progress'>       </div>     </div>    </div></div><div class='chrome-shark-artist-bio' style='display:none'> <span class='chrome-shark-artist-summary-title'>Artist summary </span> <p class='chrome-shark-artist-bio-summary'></p></div><div class='chrome-shark-track-no-info'> <span>No songs are currently playing. </br>Close Chrome-Shark and add some ! </span></div>"),h.find(".logo-chrome").css({"font-family":"'Righteous', cursive","font-style":"normal",color:"#00B0D0","font-size":"20pt"}),h.find(".logo-shark").css({"font-family":"'Righteous', cursive","font-style":"normal",color:"#adadad","font-size":"20pt"}),c.find(".chrome-shark-title").css({"font-size":"20pt","line-height":"30px"}),c.find(".chrome-shark-artist-container").css({"font-weight":"lighter","font-size":"15pt","margin-top":"15px"}),c.find(".chrome-shark-artist-summary-title").css({"font-size":"20pt","line-height":"30px"}),c.find(".chrome-shark-track-controls").css({"margin-top":"10%",position:"relative",width:"100%","background-color":"#181818",padding:"15px","box-sizing":"border-box","ms-box-sizing":"border-box","webkit-box-sizing":"border-box","moz-box-sizing":"border-box","border-radius":"7px",color:"white","margin-bottom":"40px","min-height":"100px"}),c.find(".chrome-shark-track-controls .chrome-shark-time-elapsed-total").css({color:"#FFF","font-size":"26px","text-align":"center","margin-top":"10px"}),c.find(".chrome-shark-progress-bar").css({"background-color":"#4E4E4E",height:"8px",width:"100%","border-radius":"4px",position:"relative",margin:"10px 0px 10px 0px"}),c.find(".chrome-shark-progress-bar-current-progress").css({position:"absolute",top:"0",left:"0",width:"0px","background-color":"#007ACC",height:"8px","border-radius":"4px"}),a.call(this,c),c.find(".chrome-shark-artist-bio-summary").css({"font-size":"12pt","line-height":"20pt","font-weight":"bold"});var m=n("<div class=chrome-shark-meta-data>").css({display:"block",width:"45%",height:"100%","z-index":"99999999999","float":"right",position:"relative","font-family":"sans-serif","text-align":"center",background:"linear-gradient(#111119 0%, #0C3A5F 100%)",filter:"progid:DXImageTransform.Microsoft.gradient( startColorstr='#000c1f', endColorstr='#00203a',GradientType=0 )"}).append(h).append(c);e.append(o).append(m),n("body").after(e)}s.call(this),this.Flip(!0)},this.Flip=function(t){if(!t){var e=n(".chrome-shark-meta-data").css("float"),a="";a="left"==e?"right":"left",n(".chrome-shark-meta-data").css("float",a),n(".chrome-shark-album-art-container").css("float",e)}var s=this;clearTimeout(this.flipTimeout),this.flipTimeout=setTimeout(function(){s.Flip()},r.flipTime)},this.IsUICreated=function(){var t=n(".chrome-shark");return t&&t.length>0},this.IsUIVisible=function(){var t=n(".chrome-shark");return t&&t.is(":visible")},this.Close=function(){clearTimeout(this.updateMetaDataTimeout),clearTimeout(this.flipTimeout),n(".chrome-shark").hide()},this.DetectInterfaceType=function(){this.chromeSharkInterface=this.Interface.Grooveshark,-1==location.host.indexOf("grooveshark")&&(this.chromeSharkInterface=this.Interface.Spotify)},this.GetDependencies=function(r){if(window.jQuery)n=jQuery,r();else{var e=document.createElement("script");e.src="",t.prototype.GetScript("//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js",function(){jQuery.noConflict(),n=jQuery,r()})}},i.call(this)}var r={updateTimeMetaData:200,updateTimePlayerControls:3e3,flipTime:3e5,defaultAlbumArtUrl:"http://cdn.last.fm/flatness/responsive/2/noimage/default_album_300_g4.png",lastFmApiKey:"ad333b16177f470aa55bd705557d5727",lastFmSecret:"0ec337aaa1272e22a3c9f86c76480461"};return t.prototype.ToggleShow=function(){this.IsUIVisible()?this.Close():this.Show()},t.prototype.GetScript=function(t,r){var e=document.createElement("script");e.type="text/javascript",e.src=t,e.onload=r,e.onreadystatechange=function(){"complete"==this.readyState&&r()},document.body.appendChild(e)},t.prototype.Interface={Grooveshark:0,Spotify:1},t}();if("undefined"!=typeof ChromeShark)window.chromeShark?window.chromeShark.ToggleShow():window.chromeShark=new ChromeShark;else{var url=location.protocol+"//tareck117.github.io/chrome-shark/js/app/chrome-shark.min.js",script=document.createElement("script");script.setAttribute("language","JavaScript"),script.setAttribute("src",url+"?rand="+(new Date).getTime()),document.body.appendChild(script)}